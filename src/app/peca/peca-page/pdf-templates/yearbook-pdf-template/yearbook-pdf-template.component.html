<button class="btn btn-primary not-print" (click)="print()">Generar PDF</button>

<ng-container *ngIf="!!pdfData">
  <main class="yearbook-pdf">
    <ng-container *ngIf="!!frontpage">
      <section class="page background--front-page">
        <div class="page__content layout--front">
          <div class="head">
            <div class="headings">
              <p>{{ frontpage.data.schoolYear }}</p>
              <p>{{ frontpage.data.sponsorName }}</p>
            </div>
            <div class="partner-img">
              <img [src]="frontpage.data.sponsorLogo" />
            </div>
          </div>
          <div class="body">
            <h1>AmbLeMario</h1>
            <h2>{{ frontpage.data.schoolName }}</h2>
          </div>
        </div>
      </section>
    </ng-container>

    <ng-container *ngIf="!!summaryAndCoordinatorPage">
      <section class="page background--generic">
        <div class="page__content layout--2">
          <div class="row">
            <div class="col">
              <div class="container-img">
                <img
                  [src]="summaryAndCoordinatorPage.data.historicalReviewImg"
                />
              </div>
            </div>

            <div class="col">
              <div>
                <h3 class="title">Reseña histórica</h3>
                <p>
                  <span
                    [outerHTML]="
                      summaryAndCoordinatorPage.data.historicalReviewText
                        | excerpt: 627
                        | br
                    "
                  ></span>
                </p>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="container-img">
                <img [src]="summaryAndCoordinatorPage.data.coordinatorImg" />
              </div>
            </div>

            <div class="col">
              <div>
                <h3 class="title">
                  Coordinador/a
                  {{ summaryAndCoordinatorPage.data.coordinatorName }}
                </h3>
                <p>
                  <span
                    [outerHTML]="
                      summaryAndCoordinatorPage.data.coordinatorText
                        | excerpt: 627
                        | br
                    "
                  ></span>
                </p>
              </div>
            </div>
          </div>
        </div>
      </section>
    </ng-container>

    <ng-container *ngIf="!!godfatherPage">
      <ng-container
        *ngTemplateOutlet="layout3; context: { data: godfatherPage.data }"
      ></ng-container>
    </ng-container>

    <ng-container *ngIf="!!schoolPage">
      <ng-container
        *ngTemplateOutlet="layout3; context: { data: schoolPage.data }"
      ></ng-container>
    </ng-container>

    <ng-container *ngIf="!!schoolSectionsPage">
      <ng-container
        *ngFor="let schoolSectionSegmented of getSchoolSectionsSegmented()"
      >
        <ng-container
          *ngTemplateOutlet="
            largeSchoolSection;
            context: {
              data: schoolSectionSegmented,
              studentsSegmented: getStudentsSegmented(
                schoolSection.sectionStudents,
                schoolSection.sectionImg
              )
            }
          "
        ></ng-container>
      </ng-container>
    </ng-container>
  </main>
</ng-container>

<div class="loading not-print" *ngIf="isProd">
  <img src="../../../../../assets/images/amblema-loader.gif" />
</div>

<ng-template #layout3 let-data="data">
  <section class="page background--generic">
    <div class="page__content layout--3">
      <div class="row body">
        <div class="col col-img--centered">
          <div class="container-img">
            <img [src]="data.img" />
          </div>
        </div>
        <div class="col overflow--hidden">
          <p class="tag-title">{{ data.tagTitle }}</p>
          <h2 class="text-capitalize">
            {{ data.name }}
          </h2>

          <p>
            <span [outerHTML]="data.text | excerpt: 1122 | br"></span>
          </p>
        </div>
      </div>
    </div>
  </section>
</ng-template>

<ng-template
  #largeSchoolSection
  let-data="data"
  let-studentsSegmented="studentsSegmented"
>
  <section class="page background--generic">
    <div class="page__content layout--4">
      <div class="row body">
        <div class="col overflow--hidden">
          <h2 class="text-capitalize">
            {{ data.sectionName }}
          </h2>

          <ul class="list">
            <ng-container *ngFor="let name of studentsSegmented.large">
              <li>{{ name }}</li>
            </ng-container>
          </ul>
        </div>
        <div class="col overflow--hidden">
          <h2 class="text-capitalize">
            {{ data.sectionName }}
          </h2>
          <ng-container *ngIf="data.sectionImg">
            <div class="container-img">
              <img [src]="data.sectionImg" />
            </div>
          </ng-container>

          <ul class="list small padding-top">
            <ng-container *ngFor="let name of studentsSegmented.small">
              <li>{{ name }}</li>
            </ng-container>
          </ul>
        </div>
      </div>
    </div>
  </section>
</ng-template>

<ng-template #smallSchoolSection let-data="data">
  <section class="page background--generic">
    <div class="page__content layout--4">
      <div class="row body">
        <div class="col overflow--hidden">
          <h2 class="text-capitalize">
            {{ data[0].sectionName }}
          </h2>

          <ul class="list">
            <ng-container *ngFor="let name of data[0].sectionStudents">
              <li>{{ name }}</li>
            </ng-container>
          </ul>
        </div>
        <div class="col overflow--hidden">
          <h2 class="text-capitalize">
            {{ data[1].sectionName }}
          </h2>
          <!-- <ng-container *ngIf="data.sectionImg">
            <div class="container-img">
              <img [src]="data[1].sectionImg" />
            </div>
          </ng-container> -->

          <ul class="list small padding-top">
            <ng-container *ngFor="let name of data[1].sectionStudents">
              <li>{{ name }}</li>
            </ng-container>
          </ul>
        </div>
      </div>
    </div>
  </section>
</ng-template>
